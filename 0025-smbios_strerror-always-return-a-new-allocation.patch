From 460b1910d7ab2897b3c50537b75284435bd8b03a Mon Sep 17 00:00:00 2001
From: Peter Jones <pjones@redhat.com>
Date: Wed, 18 Apr 2018 10:40:44 -0400
Subject: [PATCH 25/27] smbios_strerror(): *always* return a new allocation.

Related: rhbz#1562440

Signed-off-by: Peter Jones <pjones@redhat.com>
---
 src/libsmbios_c/smbios/smbios.c | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/src/libsmbios_c/smbios/smbios.c b/src/libsmbios_c/smbios/smbios.c
index f7b90109136..745be4d5cd0 100644
--- a/src/libsmbios_c/smbios/smbios.c
+++ b/src/libsmbios_c/smbios/smbios.c
@@ -74,11 +74,10 @@ char *smbios_strerror(const struct smbios_struct *cur)
     char *ret;
     struct smbios_table *table = smbios_table_factory(SMBIOS_DEFAULTS | SMBIOS_NO_ERR_CLEAR);
     if (table) {
-        /* leak */
         ret = strdup(smbios_table_strerror(table));
         smbios_table_free(table);
     } else {
-        ret = "";
+        ret = strdup("");
     }
     return ret;
 }
-- 
2.15.0

